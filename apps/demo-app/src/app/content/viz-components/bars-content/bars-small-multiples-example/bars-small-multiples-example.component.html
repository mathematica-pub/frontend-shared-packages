<div class="bars-example" *ngIf="vm$ | async as vm; else loading">
  <p class="ui-instructions">Select a bars direction</p>
  <mat-button-toggle-group
    class="direction-toggle-group"
    [hideSingleSelectionIndicator]="true"
    [value]="(layoutProperties$ | async).orientation"
    (change)="updateOrientation($event.value)"
    ><mat-button-toggle value="horizontal">Horizontal</mat-button-toggle
    ><mat-button-toggle value="vertical">Vertical</mat-button-toggle>
  </mat-button-toggle-group>
  <div class="chart-container">
    @for (city of vm.dataConfig.multiples.calculatedDomain; track $index) {
      <vic-xy-chart [config]="vm.chartConfig">
        <p
          class="chart-title"
          [style.paddingLeft.px]="vm.chartConfig.margin.left"
          html-elements-before
          >{{ city }}</p
        >
        <ng-container svg-elements>
          <svg:g
            vic-primary-marks-bars
            [config]="vm.dataConfig"
            [multiple]="{ value: city, index: $index }"
            [vicBarsHoverMoveActions]="hoverAndMoveActions"
            (vicBarsHoverMoveOutput)="updateTooltipForNewOutput($event)"
          >
            <vic-html-tooltip
              [config]="tooltipConfig$ | async"
              [template]="htmlTooltip"
            ></vic-html-tooltip>
          </svg:g>
          @if ((layoutProperties$ | async).orientation === 'horizontal') {
            <svg:g vic-x-quantitative-axis [config]="vm.xAxisConfig" />
            <svg:g vic-y-ordinal-axis [config]="vm.yAxisConfig" />
          } @else {
            <svg:g vic-x-ordinal-axis [config]="vm.xAxisConfig" />
            <svg:g vic-y-quantitative-axis [config]="vm.yAxisConfig" />
          }
        </ng-container>
      </vic-xy-chart>
    }
  </div>
</div>

<ng-template #loading>Loading...</ng-template>

<ng-template #htmlTooltip>
  <div
    [style.--color]="(tooltipData$ | async).color"
    class="bars-example-tooltip-container"
  >
    @if ((layoutProperties$ | async).orientation === 'horizontal') {
      <p class="tooltip-label category">
        {{ (tooltipData$ | async).values.y }}
      </p>
      <div class="values-container">
        <p class="tooltip-label y">
          <span class="value-label">Value</span>
          {{ (tooltipData$ | async).values.x }}
        </p>
      </div>
    } @else {
      <p class="tooltip-label category">
        {{ (tooltipData$ | async).values.x }}
      </p>
      <div class="values-container">
        <p class="tooltip-label y">
          <span class="value-label">Value</span>
          {{ (tooltipData$ | async).values.y }}
        </p>
      </div>
    }
  </div>
</ng-template>
