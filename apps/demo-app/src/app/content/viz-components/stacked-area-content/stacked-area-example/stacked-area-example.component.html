<div class="stacked-area-example" *ngIf="vm$ | async as vm; else loading">
  <vic-xy-chart [config]="vm.chartConfig">
    <ng-container svg-elements>
      <svg:g vic-xy-background></svg:g>
      <svg:g
        vic-primary-marks-stacked-area
        [config]="vm.dataConfig"
        [vicStackedAreaHoverMoveActions]="hoverAndMoveActions"
        (vicStackedAreaHoverMoveOutput)="updateTooltipForNewOutput($event)"
      >
        <vic-html-tooltip
          [config]="tooltipConfig$ | async"
          [template]="htmlTooltip"
        ></vic-html-tooltip>
      </svg:g>
      <svg:g>
        <line
          *ngIf="tooltipData$ | async as tooltipData"
          class="tooltip-line"
          [attr.x1]="tooltipData.positionX"
          [attr.x2]="tooltipData.positionX"
          [attr.y1]="tooltipData.hoveredAreaTop"
          [attr.y2]="tooltipData.hoveredAreaBottom"
        ></line>
      </svg:g>
      <svg:g vic-x-quantitative-axis [config]="vm.xAxisConfig"></svg:g>
      <svg:g vic-y-quantitative-axis [config]="vm.yAxisConfig"></svg:g>
    </ng-container>
  </vic-xy-chart>
</div>
<ng-template #loading>Loading...</ng-template>

<ng-template #htmlTooltip>
  @if ((tooltipData$ | async).hoveredDatum; as data) {
    <div class="stacked-area-example-tooltip-container">
      <div class="tooltip-content" [style.--color]="data.color">
        <p class="tooltip-label category">{{ data.values.color }}</p>
        <div class="values-container">
          <p class="tooltip-label y">
            <span class="value-label">Value</span>
            {{ data.datum.value }}
          </p>
        </div>
      </div>
      <svg
        width="100%"
        height="12"
        [style.--width]="'20px'"
        class="svg-triangle"
      >
        <g class="svg-g">
          <path class="triangle-path" d="M 0,0 10,12 20,0"></path>
        </g>
      </svg>
    </div>
  }
</ng-template>
