<div class="p-2">
  <table>
    <thead>
      @for (headerGroup of table.getHeaderGroups(); track headerGroup.id) {
        <tr>
          @for (header of headerGroup.headers; track header.id) {
            @if (!header.isPlaceholder) {
              @if (header.column.getCanSort()) {
                <th>
                  <ng-container
                    *flexRender="
                      header.column.columnDef.header;
                      props: header.getContext();
                      let headerCell
                    "
                  >
                    <div
                      class="header-cell-sort"
                      (click)="header.column.toggleSorting()"
                      [class.sorting-asc]="
                        header.column.getIsSorted() === 'asc'
                      "
                      [class.sorting-desc]="
                        header.column.getIsSorted() === 'desc'
                      "
                    >
                      {{ headerCell }}
                      <span
                        [ngClass]="[
                          'material-sort-icon',
                          'material-symbols-outlined',
                        ]"
                        [class.desc]="header.column.getIsSorted() === 'desc'"
                        [class.asc]="header.column.getIsSorted() === 'asc'"
                        [class.actively-sorted]="
                          header.column.getIsSorted() !== false
                        "
                        [attr.aria-hidden]="true"
                        >{{ sortIcon }}</span
                      >
                    </div>
                  </ng-container>
                </th>
              } @else {
                <th>
                  <ng-container
                    *flexRender="
                      header.column.columnDef.header;
                      props: header.getContext();
                      let header
                    "
                  >
                    <div [innerHTML]="header"></div>
                  </ng-container>
                </th>
              }
            }
          }
        </tr>
      }
    </thead>
    <tbody>
      <tr *ngFor="let row of table.getRowModel().rows">
        <td *ngFor="let cell of row.getVisibleCells()">
          <ng-container
            *ngIf="cell.column.id === 'chartConfig'; else defaultCell"
          >
            <vic-xy-chart [config]="chartConfig">
              <ng-container svg-elements>
                <svg:g vic-xy-background></svg:g>
                <svg:g
                  vic-primary-marks-lines
                  [config]="$any(cell.getValue())"
                ></svg:g>
                <svg:g
                  vic-x-quantitative-axis
                  [config]="xAxisQuantitativeConfig"
                ></svg:g>
                <svg:g vic-y-quantitative-axis [config]="yAxisConfig"></svg:g>
              </ng-container>
            </vic-xy-chart>
          </ng-container>
          <ng-template #defaultCell>
            {{ cell.getValue() }}
          </ng-template>
        </td>
      </tr>
    </tbody>
  </table>
</div>
