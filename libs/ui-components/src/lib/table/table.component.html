<table class="table-container" cdk-table [dataSource]="data$">
  <col
    *ngFor="let column of columns$ | async; trackBy: columnTrackingFunction"
    span="1"
    [style]="'width:' + column.width"
  />

  <ng-container
    *ngFor="let column of columns$ | async; trackBy: columnTrackingFunction"
    [cdkColumnDef]="column.label"
  >
    <ng-container
      *ngIf="column.sortable; then sortIconCells; else basicCells"
    ></ng-container>
    <ng-template #sortIconCells>
      <th
        hsi-ui-single-sort-header
        scope="col"
        cdk-header-cell
        *cdkHeaderCellDef="let element"
        [ngClass]="[column.getAlignment(element), 'sorted-header']"
        [column]="column"
        [sortIcon]="sortIcon"
        (click)="sortTableByColumn(column)"
      ></th>
      <td
        cdk-cell
        [ngClass]="[column.getAlignment(element), 'sorted-header']"
        *cdkCellDef="let element"
        [attr.scope]="column.isRowHeader ? 'row' : null"
        data-cy="table-cell"
      >
        {{ column.getFormattedValue(element) }}
      </td>
    </ng-template>
    <ng-template #basicCells>
      <th
        cdk-header-cell
        *cdkHeaderCellDef="let element"
        [class]="column.getAlignment(element)"
        scope="col"
      >
        {{ column.label }}
      </th>
      <td
        cdk-cell
        [ngClass]="[column.getAlignment(element), 'sorted-cell']"
        *cdkCellDef="let element"
        [attr.scope]="column.isRowHeader ? 'row' : null"
        data-cy="table-cell"
      >
        {{ column.getFormattedValue(element) }}
      </td>
    </ng-template>
  </ng-container>

  <tr
    cdk-header-row
    class="header"
    *cdkHeaderRowDef="tableHeaders$ | async"
  ></tr>
  <tr
    cdk-row
    class="row"
    data-cy="table-row"
    *cdkRowDef="let row; columns: tableHeaders$ | async"
  ></tr>
  <ng-template></ng-template>
</table>
