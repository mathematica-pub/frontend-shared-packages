<app-component-demo [folderName]="folderName" [includeFiles]="includeFiles">
  <span title class="title">Lines</span>
  <ng-container demo *ngIf="vm$ | async as vm; else loading">
    <button class="download-button" (click)="downloadImage()"
      >download image as jpeg</button
    >
    <button
      class="download-button"
      (click)="downloadService.saveCSV(vm.dataConfig.data, 'lines-example', ['date'])"
      >download as csv</button
    >
    <div #imageNode>
      <p>Select a tooltip display event</p>
      <mat-button-toggle-group
        name="tooltipEvent"
        aria-label="Tooltip Event"
        [value]="tooltipEvent$ | async"
        (change)="onEventToggleChange($event)"
      >
        <mat-button-toggle value="hover">On Hover</mat-button-toggle>
        <mat-button-toggle value="click">On Click</mat-button-toggle>
      </mat-button-toggle-group>
      <div class="effect-container">
        <p class="effect-title">Lines Input Event example</p>
        <p class="effect-instruction">Hover any name to see effect in chart</p>
        <div class="line-labels-container">
          <p
            class="line-label"
            *ngFor="let label of vm.labels"
            [style.paddingLeft.px]="margin.left"
            (mouseenter)="highlightLine(label)"
            (mouseleave)="highlightLine(null)"
            >{{ label }}</p
          >
        </div>
      </div>
      <ng-container
        *ngIf="(tooltipEvent$ | async) === 'hover'; else clickTooltipChart"
      >
        <vic-xy-chart [margin]="margin" #tooltipOrigin>
          <ng-container svg-elements>
            <svg:g vic-xy-background></svg:g>
            <svg:g
              vic-x-quantitative-axis
              [config]="vm.xAxisConfig"
              side="bottom"
            ></svg:g>
            <svg:g
              vic-y-quantitative-axis
              [config]="vm.yAxisConfig"
              side="left"
            ></svg:g>
            <svg:g
              vic-data-marks-lines
              [config]="vm.dataConfig"
              [vicLinesHoverAndMoveEffects]="hoverEffects"
              (vicLinesHoverAndMoveOutput)="updateTooltipForNewOutput($event, 'hover')"
              [vicLinesInputEffects]="[highlightLineForLabelEffect]"
              [vicLinesInputEvent$]="chartInputEvent$"
            >
              <vic-html-tooltip
                [config]="(tooltipConfig$ | async)"
                [template]="htmlTooltip"
              ></vic-html-tooltip>
            </svg:g>
          </ng-container>
        </vic-xy-chart>
      </ng-container>

      <ng-template #clickTooltipChart>
        <vic-xy-chart [margin]="margin" #tooltipOrigin>
          <ng-container svg-elements>
            <svg:g vic-xy-background></svg:g>
            <svg:g
              vic-x-quantitative-axis
              [config]="vm.xAxisConfig"
              side="bottom"
            ></svg:g>
            <svg:g
              vic-y-quantitative-axis
              [config]="vm.yAxisConfig"
              side="left"
            ></svg:g>
            <svg:g
              vic-data-marks-lines
              [config]="vm.dataConfig"
              [vicLinesHoverAndMoveEffects]="hoverEffects"
              [vicLinesMarkerClickEffects]="clickEffects"
              [vicLinesMarkerClickRemoveEvent$]="removeTooltipEvent$"
              [vicLinesInputEffects]="[highlightLineForLabelEffect]"
              [vicLinesInputEvent$]="chartInputEvent$"
              (vicLinesMarkerClickOutput)="updateTooltipForNewOutput($event, 'click')"
            >
              <vic-html-tooltip
                [config]="(tooltipConfig$ | async)"
                [template]="htmlTooltip"
                (backdropClick)="onBackdropClick()"
              ></vic-html-tooltip>
            </svg:g>
          </ng-container>
        </vic-xy-chart>
      </ng-template>
    </div>
  </ng-container>
  <ng-template #loading>Loading...</ng-template>
</app-component-demo>

<ng-template #htmlTooltip>
  <div [style.--color]="(tooltipData$ | async).color" class="tooltip-container">
    <p class="tooltip-label category">
      {{ (tooltipData$ | async).category }}
    </p>
    <div class="values-container">
      <p class="tooltip-label x">
        <span class="value-label">Date</span>
        {{ (tooltipData$ | async).x }}
      </p>
      <p class="tooltip-label y">
        <span class="value-label">Value</span>
        {{ (tooltipData$ | async).y }}
      </p>
    </div>
  </div>
</ng-template>
